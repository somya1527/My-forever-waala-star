<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galaxy Letter</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
body{
    margin:0;
    overflow:hidden;
    background:black;
    font-family:Poppins, sans-serif;
}

/* Static Galaxy Background */
#galaxy{
    position:fixed;
    inset:0;
    background:url("galaxy.jpg") center center / cover no-repeat;
    z-index:0;
    opacity:0;
    transition:opacity 2s ease;
    animation:breathing 20s ease-in-out infinite;
    pointer-events:none;
}

/* subtle breathing zoom */
@keyframes breathing{
    0%{ transform:scale(1); }
    50%{ transform:scale(1.03); }
    100%{ transform:scale(1); }
}

/* depth star layer */
#starsLayer{
    position:fixed;
    inset:0;
    z-index:1;
    pointer-events:none;
}

/* vignette for realism */
#vignette{
    position:fixed;
    inset:0;
    background:radial-gradient(circle at center,
        rgba(0,0,0,0) 60%,
        rgba(0,0,0,0.7) 100%);
    z-index:2;
    pointer-events:none;
}

canvas{
    display:block;
    position:relative;
    z-index:3;
}

#letter{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    width:80%;
    max-width:700px;
    text-align:center;
    color:white;
    opacity:0;
    transition:opacity 2s ease;
    line-height:1.6;
    font-size:18px;
    pointer-events:none;
    z-index:4;
}
</style>
</head>
<body>

<div id="galaxy"></div>
<canvas id="starsLayer"></canvas>
<div id="vignette"></div>

<canvas id="canvas"></canvas>

<div id="letter">
    <h2>To My Star,</h2>
    <p>Out of all the chaos in this universe, you are the light that feels constant.</p>
    <p>I didnâ€™t just meet someone. I found moy forever tara that I was always meant to find.</p>
    <p>In a sky full of different stars, you are the one that I stare at.</p>
    <p>You are the reason I get to poop normally everyday. THANK YOU!! I LOVE YOU SMURFF!!.</p>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const starCanvas = document.getElementById("starsLayer");
const starCtx = starCanvas.getContext("2d");

const galaxy = document.getElementById("galaxy");
const letter = document.getElementById("letter");

function resize(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    starCanvas.width = window.innerWidth;
    starCanvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

let stars = [];
let driftingStars = [];
let clickCount = 0;
const requiredStars = 200;
let reveal = false;
let collapse = false;
let collapseFrames = 0;

/* clickable stars */
class Star{
    constructor(x,y){
        this.x = x;
        this.y = y;
        this.vx = (Math.random()-0.5)*2;
        this.vy = (Math.random()-0.5)*2;
        this.size = 1 + Math.random()*2;
    }
    update(){
        if(!collapse){
            this.x += this.vx;
            this.y += this.vy;
            if(this.x<0||this.x>canvas.width) this.vx*=-1;
            if(this.y<0||this.y>canvas.height) this.vy*=-1;
        } else {
            this.x += (canvas.width/2 - this.x)*0.02;
            this.y += (canvas.height/2 - this.y)*0.02;
        }
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
        ctx.fillStyle="white";
        ctx.fill();
    }
}

/* drifting depth stars */
for(let i=0;i<300;i++){
    driftingStars.push({
        x:Math.random()*starCanvas.width,
        y:Math.random()*starCanvas.height,
        size:Math.random()*2,
        speed:0.2+Math.random()*0.5
    });
}

function animateDrift(){
    starCtx.clearRect(0,0,starCanvas.width,starCanvas.height);
    driftingStars.forEach(s=>{
        s.y += s.speed;
        if(s.y>starCanvas.height){
            s.y = 0;
            s.x = Math.random()*starCanvas.width;
        }
        starCtx.fillStyle="rgba(255,255,255,0.8)";
        starCtx.fillRect(s.x,s.y,s.size,s.size);
    });
    requestAnimationFrame(animateDrift);
}
animateDrift();

canvas.addEventListener("click",(e)=>{
    if(!reveal){
        stars.push(new Star(e.clientX,e.clientY));
        clickCount++;
    }
});

function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    if(!reveal){
        stars.forEach(s=>s.update());

        ctx.font="14px Poppins";
        ctx.textAlign="center";
        ctx.fillStyle="rgba(255,255,255,0.6)";
        ctx.fillText(
            "Stars created: " + clickCount + " / " + requiredStars,
            canvas.width/2,
            40
        );

        if(clickCount>=requiredStars){
            collapse = true;
            collapseFrames++;
            if(collapseFrames>200){
                reveal = true;
                galaxy.style.opacity = 1;
                setTimeout(()=>{
                    letter.style.opacity = 1;
                },1000);
            }
        }
    }

    requestAnimationFrame(animate);
}
animate();
</script>

</body>
</html>

